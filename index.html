<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mini Excel Editor — Debuggable Build (CSV/XLSX)</title>
<link rel="shortcut icon" href="data:image/x-icon;," />
<link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Mini Excel Editor</h1>
    <button id="newSheet" title="New blank sheet">New</button>
    <button id="addRow" title="Add a row">+ Row</button>
    <button id="addCol" title="Add a column">+ Col</button>
    <button id="delRow" title="Delete last row">– Row</button>
    <button id="delCol" title="Delete last column">– Col</button>
    <input id="formulaBar" type="text" placeholder="fx" />
    <button id="boldBtn" title="Bold"><b>B</b></button>
    <button id="italicBtn" title="Italic"><i>I</i></button>
    <input id="fillColor" type="color" title="Fill color" />
    <button id="undoBtn" title="Undo">Undo</button>
    <button id="redoBtn" title="Redo">Redo</button>

    <div class="toolbar">
      <label class="btn-file" title="Open CSV/XLSX">
        Open
        <input id="fileInput" type="file" accept=".csv, text/csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, .xlsx" />
      </label>
      <button id="saveCSV" title="Download as CSV">Export CSV</button>
      <button id="saveXLSX" title="Download as XLSX">Export XLSX</button>
      <div id="sheetTabs" class="sheetTabs"></div>
      <button id="runTests" title="Quick self-test">Run Tests</button>
      <button id="toggleDebug" title="Show/hide debug log">Debug</button>
      <button id="copyDebug" title="Copy debug report">Copy Report</button>
    </div>
  </header>

  <div class="wrap">
    <div class="sheet">
      <table id="grid">
        <thead></thead>
        <tbody></tbody>
      </table>
    </div>
    <div class="status">
      <span class="pill hint">Tip: use formulas like <code>=A1+B2*2</code> or <code>=SUM(A1:A5,B2)</code></span>
      <span id="calcState" class="pill">Ready</span>
      <span id="xlsxState" class="pill">XLSX: not loaded</span>
      <span id="fileInfo" class="pill"></span>
    </div>

    <div id="debugBox" class="debug" style="display:none">
      <h3>Debug Log</h3>
      <pre id="debugOut"></pre>
    </div>
  </div>

<script type="module" src="app.js"></script>
</body>
</html>
